<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dumbbell Plot â€“ NZ Regional GDP</title>
  <script src="https://d3js.org/d3.v6.min.js"></script>  
  <script src="scripts/GDPCharting.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/save-svg-as-png/1.4.17/saveSvgAsPng.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <link rel="stylesheet" href="styles/chartstyles.css">  
</head>
<body>
  <div id="uberChartContainer">

    <div class="chart-container" id="NZRegionalGDP2024-GrowthFrom2000to2004chart">
      <h2>NZ Regional GDP: Growth from 2000 to 2024</h2>
      <svg id="NZRegionalGDP2024-GrowthFrom2000to2004" width="800" height="400"></svg>
    </div>

    <div class="chart-container" id="NorthIslandGDP2024-GrowthFrom2000to2004chart">
      <h2>NZ North Island GDP: Growth from 2000 to 2024</h2>
      <svg id="NorthIslandGDP2024-GrowthFrom2000to2004" width="800" height="400"></svg>
   </div>

   <div class="chart-container" id="SouthIslandGDP2024-GrowthFrom2000to2004chart">
      <h2>NZ South Island GDP: Growth from 2000 to 2024</h2>
      <svg id="SouthIslandGDP2024-GrowthFrom2000to2004" width="800" height="400"></svg>
    </div>

    <div class="chart-container" id="NZRegionalGDPPerCapita2024-GrowthFrom2000to2004chart">
      <h2>NZ Regional GDP per capita: Growth from 2000 to 2024</h2>
      <svg id="NZRegionalGDPPerCapita2024-GrowthFrom2000to2004" width="800" height="400"></svg>
    </div>

    <div class="chart-container" id="NorthIslandGDPPerCapita2024-GrowthFrom2000to2004chart">
      <h2>NZ North Island GDP per capita: Growth from 2000 to 2024</h2>
      <svg id="NorthIslandGDPPerCapita2024-GrowthFrom2000to2004" width="800" height="400"></svg>
   </div>

    <div class="chart-container" id="SouthIslandGDPPerCapita2024-GrowthFrom2000to2004chart">
      <h2>NZ South Island GDP per capita: Growth from 2000 to 2024</h2>
      <svg id="SouthIslandGDPPerCapita2024-GrowthFrom2000to2004" width="800" height="400"></svg>
    </div>

    <div class="dumbellplot-tooltip" id="tooltip"></div>

    <div><button onclick="downloadAllContainers()">Download All Charts</button></div>
</div>
  <script type="module">
    
    document.addEventListener("DOMContentLoaded", async () => {
      const regionMeta = await d3.csv("https://raw.githubusercontent.com/rm80/decoded/refs/heads/main/data/statsnz/New%20Zealand%20Regions.csv");
      const allRegions = regionMeta.map(d => d.Region);
      const northRegions = regionMeta.filter(d => d["Regions Group"] === "North Island").map(d => d.Region);
      const southRegions = regionMeta.filter(d => d["Regions Group"] === "South Island").map(d => d.Region);

      GDPCharting.renderDumbbellPlot({
        containerId: "NZRegionalGDP2024-GrowthFrom2000to2004",
        metric: "Gross Domestic Product",
        startYear: 2000,
        endYear: 2024,
        sort: "growth-desc",
        regionList: allRegions
      });

      GDPCharting.renderDumbbellPlot({
        containerId: "NorthIslandGDP2024-GrowthFrom2000to2004",
        metric: "Gross Domestic Product",
        startYear: 2000,
        endYear: 2024,
        sort: "growth-desc",
        regionList: northRegions
      });

      GDPCharting.renderDumbbellPlot({
        containerId: "SouthIslandGDP2024-GrowthFrom2000to2004",
        metric: "Gross Domestic Product",
        startYear: 2000,
        endYear: 2024,
        sort: "growth-desc",
        regionList: southRegions
      });

      GDPCharting.renderDumbbellPlot({
        containerId: "NZRegionalGDPPerCapita2024-GrowthFrom2000to2004",
        metric: "GDP per capita",
        startYear: 2000,
        endYear: 2024,
        sort: "growth-desc",
        regionList: allRegions
      });

      GDPCharting.renderDumbbellPlot({
        containerId: "NorthIslandGDPPerCapita2024-GrowthFrom2000to2004",
        metric: "GDP per capita",
        startYear: 2000,
        endYear: 2024,
        sort: "growth-desc",
        regionList: northRegions
      });

      GDPCharting.renderDumbbellPlot({
        containerId: "SouthIslandGDPPerCapita2024-GrowthFrom2000to2004",
        metric: "GDP per capita",
        startYear: 2000,
        endYear: 2024,
        sort: "growth-desc",
        regionList: southRegions
      });

      const tooltip = d3.select("#dumbellplot-tooltip");
  });
  </script>
</body>
</html>
